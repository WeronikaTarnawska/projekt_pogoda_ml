---
title: Modelowanie danych pogodowych jako szereg czasowy
authors: 
  - Weronika Tarnawska
  - Michał Łukasik
options:
  implicit_slide_ends: true
  end_slide_shorthand: true
  command_prefix: "cmd: "
  image_attributes_prefix: ""
theme:
  name: light
  override:
    default:
      colors:
        background: "fbf1c7"
        foreground: "3c3836"

    intro_slide:
      title:
        colors:
          foreground: "427b58"
      author:
        colors:
          foreground: "7c6f64"

    slide_title:
      colors:
        foreground: "427b58"
      padding:
        bottom: 1
      alignment: center

    code:
      colors:
        background: "f2e5bc"
        foreground: "3c3836"
---

<!-- 
TODO co tu musi być:
1. Na jakich danych Państwo pracują i jaki jest cel projektu?
2. Na jakie pytania / hipotezy ma odpowiedzieć przeprowadzana analiza danych?
3. Jaki jest plan realizacji całości projektu?
4. Co udało się już zrealizować i jakie wyniki Państwo uzyskali? 
-->

Cel
===

Predykcja pogody na podstawie danych historycznych

- Normalnie pogodę prognozuje się rozwiązując równania różniczkowe z danych z atmosfery
- My chcemy podjąć próbę modelowania pogody jako szereg czasowy
- I zobaczyć jak dużo (czy cokolwiek) ponad losowy szum da się w ten sposób przewidzieć

Dane
====

- [Meteostat](https://dev.meteostat.net/python)
- Bazowo tylko stacja Wrocław.
- Ale może użyjemy kilku innych.

![width:50%](./tmp/df_hourly_head.png)

<!-- cmd: column_layout: [1, 1] -->
<!-- cmd: column: 0 -->
- **temp** = Temperatura powietrza
- **rhum** = Wilgotność względna
- **prcp** = Opady (godzinowa suma)
- **snwd** = Głębokość pokrywy śnieżnej
- **wdir** = Kierunek wiatru
- **wspd** = Średnia prędkość wiatru
<!-- cmd: column: 1 -->
- **wpgt** = Szczytowy poryw wiatru
- **pres** = Ciśnienie atmosferyczne
- **tsun** = Czas nasłonecznienia
- **cldc** = Zachmurzenie ogólne
- **coco** = Kod warunków pogodowych
<!-- cmd: reset_layout -->

Plan
====

### Chcemy zacząć od prostych modeli pokazujące oczywiste rzeczy na temat pogody

1. Pogoda jutro będzie taka sama jak dzisiaj
2. Pogoda zawsze jest jakąś średnią z aktualnego miesiąca
3. Pogoda składa się z trendu sezonowego (pory roku), lokalnego (dzień vs noc)
   i losowego szumu

### Plan na metody które mają tu coś poprawić

- Metody typowe dla szeregów czasowych: SARIMA
  - (model do predykcji szeregów czasowych które wykazują jakiś trend)
- Feature engineering + uczenie zespołowe
- Przetestowanie istniejących narzędzi do tego typu zadań: Facebook prophet
- Użycie danych z sąsiednich stacji i kierunku wiatru

Co już zrobiliśmy
================

![width:100%](wykres_cykle_godzinowe.png)

Co już zrobiliśmy
================

![width:80%](wykres_sezonowosc_prosty.png)

Co już zrobiliśmy
================

![width:80%](wykres_trendy_roczne.png)

Co już zrobiliśmy
================

### Modele baseline dla predykcji temperatury

```txt
--- Baseline 1: Persistence ---
[Day  ] RMSE: 2.87, MAE: 2.22, R2: 0.89
[Night] RMSE: 2.96, MAE: 2.31, R2: 0.83

--- Baseline 2: Monthly Average ---
[Day  ] RMSE: 4.21, MAE: 3.44, R2: 0.76
[Night] RMSE: 3.77, MAE: 3.01, R2: 0.73

--- Baseline 3: Decomposition (+Noise) ---
[Day  ] RMSE: 6.07, MAE: 4.95, R2: 0.50
[Night] RMSE: 5.51, MAE: 4.41, R2: 0.43
```

Co już zrobiliśmy
================

### Feature engineering + uczenie zespołowe

![width:80%](./xgb_demo_result.png)

Co już zrobiliśmy
================

### Feature engineering + uczenie zespołowe

![width:80%](./xgb_importance.png)

Co już zrobiliśmy
================

### Feature engineering + uczenie zespołowe

```txt
--- XGBoost ---
RMSE: 1.81 °C
MAE:  1.37 °C
R2:   0.9460
```

```txt
--- Baseline 0: Persistence whole day ---
RMSE: 3.78, MAE: 3.02, R2: 0.81
```

Ciąg dalszy
===========

- Punkty z planu których nie ma w częściowych wynikach
- Prognoza deszczu
